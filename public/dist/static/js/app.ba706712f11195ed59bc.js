webpackJsonp([6],{"7zck":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW"),o=n("Dd8w"),s=n.n(o),a=n("NYxO"),i={data:function(){return{drawer:!0}},created:function(){this.initApp()},computed:Object(a.c)("UsersStore",["thisUser"]),methods:s()({},Object(a.b)(["initApp","logOut"]),{signOut:function(){this.logOut(),this.$router.push("/")}}),watch:{$route:function(){this.drawer=!1}},name:"App"},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{dark:"dark"}},[t.thisUser?n("v-navigation-drawer",{attrs:{fixed:"fixed",app:"app"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",[n("v-list-tile",["Admin"===t.thisUser.role?n("v-btn",{attrs:{to:"/admin/categories",flat:"flat"}},[t._v("Рубрики")]):t._e()],1),n("v-list-tile",[n("v-btn",{attrs:{to:"/admin/posts",flat:"flat"}},[t._v("Новий запис")])],1),n("v-list-tile",[n("v-btn",{attrs:{to:"/admin/postsList",flat:"flat"}},[t._v("Усі запис")])],1),n("v-list-tile",["Admin"===t.thisUser.role?n("v-btn",{attrs:{to:"/admin/authors",flat:"flat"}},[t._v("Автори")]):t._e()],1)],1)],1):t._e(),n("v-toolbar",{attrs:{app:"app"}},[t.thisUser?n("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}):t._e(),n("v-toolbar-title",[n("span",{staticClass:"blue--text"},[t._v("Info")]),n("span",{staticClass:"red--text"},[t._v("News ")]),n("span",[t._v("| Адмінпанель")])]),n("v-spacer"),t.thisUser?n("v-toolbar-title",[t._v(t._s(t.thisUser.name))]):t._e(),n("v-btn",{attrs:{color:"warning"},nativeOn:{click:function(e){return t.signOut(e)}}},[t._v("Вийти")])],1),n("v-content",[n("v-slide-y-transition",{attrs:{mode:"out-in"}},[n("router-view")],1)],1),n("v-footer",{attrs:{app:"app"}},[n("span",[t._v("© 2018")])])],1)},staticRenderFns:[]},u=n("VU/8")(i,c,!1,null,null,null).exports,l=n("/ocq");r.a.use(l.a);var d=new l.a({routes:[{path:"/",name:"Index",component:function(){return n.e(1).then(n.bind(null,"yhDi"))}},{path:"/admin",redirect:"/admin/posts"},{path:"/admin/posts",name:"Posts",component:function(){return n.e(0).then(n.bind(null,"uMWv"))}},{path:"/admin/categories",name:"Categories",component:function(){return n.e(4).then(n.bind(null,"pRgA"))}},{path:"/admin/postsList",name:"PostsList",component:function(){return n.e(2).then(n.bind(null,"yoeF"))}},{path:"/admin/authors",name:"Authors",component:function(){return n.e(3).then(n.bind(null,"hfmQ"))}}]}),p=n("//Fk"),f=n.n(p),g=n("mtWM"),h=n.n(g),m={getAllCategories:function(){return h.a.get("/api/allCategories").then(function(t){return t.data}).catch(function(t){return console.error(t),[]})},addNewCategory:function(t){return h.a.post("/api/addCategory",t).then(function(t){return console.log(t),t.data}).catch(function(t){return console.error(t)})},editCategory:function(t){return h.a.put("/api/editCategory",t).then(function(t){return console.log(t),t.data}).catch(function(t){return console.error(t)})},removeCategory:function(t){return h.a.delete("/api/removeCategory/"+t).then(function(t){return console.log(t),t.data}).catch(function(t){return console.error(t)})}},w=n("mvHQ"),v=n.n(w),P=function(t){console.log(t);var e=new FormData;return e.append("title",t.title),e.append("shortcat",t.shortcat),e.append("picture",t.picture),e.append("views",t.views),e.append("content",t.content),e.append("categories",v()(t.categories)),e},U={categoriesApi:m,postsApi:{getPostById:function(t){return h.a.get("/api/post/"+t).then(function(t){return t.data}).catch(function(t){return console.error(t),[]})},getAllPostsPreview:function(t){return h.a.get("/api/postsAll",{headers:{token:t}}).then(function(t){return console.log(t.data),t.data}).catch(function(t){return console.error(t),[]})},addNewPost:function(t,e){return h.a.post("/api/addNewPost",P(t),{headers:{token:e}}).then(function(t){return t.data}).catch(function(t){throw new Error(t.response.data.message)})},editPost:function(t,e,n){return h.a.put("/api/editPost/"+e,P(t),{headers:{token:n}}).then(function(t){return t.data}).catch(function(t){throw new Error(t.response.data.message)})},removePost:function(t){return h.a.delete("/api/removePost/"+t).then(function(t){return t.data}).catch(function(t){throw new Error(t.response.data.message)})}},usersApi:{getCurrentUser:function(t){return h.a.get("/api/getCurrentUser",{headers:{token:t}}).then(function(t){return t.data}).catch(function(){})},getAllUsers:function(){return h.a.get("/api/getAllUsers").then(function(t){return t.data}).catch(function(){return[]})},createNewUser:function(t){return h.a.post("/api/createNewUser",t).then(function(t){return t.data}).catch(function(t){throw new Error(t.response.data.message)})}},logIn:function(t){return h.a.post("/api/logIn",t).then(function(t){return t.data}).catch(function(t){throw new Error(t.response.data.message)})},logOut:function(){return h.a.post("/api/logOut").then(function(t){return t.data}).catch(function(t){throw new Error(t.response.data.message)})},loadFiles:function(t){return h.a.post("/api/loadFiles",t).then(function(t){return t.data}).catch(function(t){throw new Error(t.response.error)})}},k={namespaced:!0,state:{data:[],selectedCategory:{title:"",link:"",subcategories:[]}},getters:{categories:function(t){return t.data},selectedCategory:function(t){return t.selectedCategory}},mutations:{},actions:{getAllCategories:function(t){return U.categoriesApi.getAllCategories().then(function(e){t.state.data=e,console.log("get categories!",t.state.data)}).catch(function(t){return console.error(t)})},addNewCategory:function(t,e){return U.categoriesApi.addNewCategory(e).then(function(t){return console.log(t),t}).catch(function(t){return console.error(t)})},editCategory:function(t,e){return U.categoriesApi.editCategory(e).then(function(t){return console.log(t),t}).catch(function(t){return console.error(t)})},removeCategory:function(t,e){return U.categoriesApi.removeCategory(e).then(function(t){return console.log(t),t}).catch(function(t){return console.error(t)})}}},A={namespaced:!0,state:{postsList:[],selectedPost:{title:"",picture:null,shortcat:"",content:"",views:0,categories:{title:"",link:"",subcategory:{title:"",link:""}},_id:""},edit:!1},getters:{posts:function(t){return t.postsList},selectedPost:function(t){return t.selectedPost},postImage:function(t){var e=t.selectedPost.picture;return e?e instanceof File?""+URL.createObjectURL(e):e:""},postCategory:function(t){return{title:t.selectedPost.categories.title,link:t.selectedPost.categories.link}},postSubcategory:function(t){return{title:t.selectedPost.categories.subcategory.title,link:t.selectedPost.categories.subcategory.link}}},mutations:{updateSelectedPost:function(t,e){t.selectedPost=e},setSelectedPost:function(t,e){t.selectedPost=e},setPostsList:function(t,e){t.postsList=e},resetPost:function(t){t.selectedPost={title:"",picture:null,shortcat:"",content:"",views:0,categories:{title:"",link:"",subcategory:{title:"",link:""}},_id:""},t.edit=!1}},actions:{submitPost:function(t){var e=t.dispatch,n=t.state;return n.edit?e("editPost").then(function(t){return n.edit=!1,t}).catch(function(t){throw new Error(t.message)}):e("addNewPost").then(function(t){return t}).catch(function(t){throw new Error(t.message)})},getPostById:function(t,e){var n=t.commit;return U.postsApi.getPostById(e).then(function(t){return n("setSelectedPost",t),!0}).catch(function(t){throw new Error(t.message)})},getAllPostsPreview:function(t){var e=t.commit;return U.postsApi.getAllPostsPreview(b.state.token).then(function(t){return e("setPostsList",t)}).catch(function(t){throw new Error(t.message)})},addNewPost:function(t){var e=t.state,n=t.commit;return U.postsApi.addNewPost(e.selectedPost,b.state.token).then(function(t){return n("resetPost"),t}).catch(function(t){throw new Error(t.message)})},editPost:function(t){var e=t.state,n=t.commit;return U.postsApi.editPost(e.selectedPost,e.selectedPost._id,b.state.token).then(function(t){return n("resetPost"),t}).catch(function(t){throw new Error(t.message)})},removePost:function(t,e){return U.postsApi.removePost(e).then(function(t){return t}).catch(function(t){throw new Error(t.message)})},choosePost:function(t,e){var n=t.dispatch;return t.state.edit=!0,n("getPostById",e)}}},y={namespaced:!0,state:{data:[],currentUser:null},getters:{users:function(t){return t.data},thisUser:function(t){return t.currentUser}},mutations:{clearUser:function(t){t.currentUser=null},setUser:function(t,e){t.currentUser=e}},actions:{getThisUser:function(t,e){return console.log("getThisUser"),U.usersApi.getCurrentUser(e).then(function(e){return t.commit("setUser",e)}).catch(function(t){return console.error(t.message)})},getAllUsers:function(t){return console.log("getAllUsers"),U.usersApi.getAllUsers().then(function(e){t.state.data=e}).catch(function(t){return console.error(t.message)})},createAuthor:function(t,e){return U.usersApi.createNewUser(e).then(function(e){return t.dispatch("getAllUsers"),e}).catch(function(t){throw new Error(t.message)})}}};r.a.use(a.a);var b=new a.a.Store({state:{token:"",validatorRules:[function(t){return!!t||"Поле обовʼязкове!"}]},mutations:{setToken:function(t,e){t.token=e,localStorage.setItem("token",e)},clearToken:function(t){t.token="",localStorage.removeItem("token")}},modules:{"СategoriesStore":k,PostsStore:A,UsersStore:y},actions:{initApp:function(t){return new f.a(function(e){localStorage.getItem("token")?(t.commit("setToken",localStorage.getItem("token")),t.dispatch("UsersStore/getThisUser",t.state.token).then(function(){return e()})):e()})},logIn:function(t,e){return U.logIn(e).then(function(e){return t.commit("setToken",e.token),t.dispatch("UsersStore/getThisUser",t.state.token),e.message})},logOut:function(t){return t.commit("clearToken"),t.commit("UsersStore/clearUser"),!0},loadFiles:function(t,e){var n=new FormData;return n.append("file",e),U.loadFiles(n)}}}),C=n("3EgV"),_=n.n(C),F=(n("7zck"),n("V2hT")),E=n.n(F);n("O5me");r.a.use(E.a,{image:{uploadURL:"/api/loadFiles"}}),r.a.use(_.a,{theme:{primary:"#ee44aa",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}),r.a.config.productionTip=!1,new r.a({el:"#app",router:d,store:b,components:{App:u},template:"<App/>"})},O5me:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.ba706712f11195ed59bc.js.map